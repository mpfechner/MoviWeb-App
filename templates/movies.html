{% extends "base.html" %}

{% block content %}
    <h2>Favorite Movies</h2>

    <!-- Link zur OMDb-API und zum manuellen Hinzufügen -->
    <p>
        <a href="{{ url_for('add_movie_from_api', user_id=user_id) }}">📥 Add from OMDb</a> |
        <a href="#add-movie-form">➕ Add manually</a>
    </p>

    <!-- Fehleranzeige, falls aus der vorherigen Request-Context übergeben -->
    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}

    <!-- Liste der Filme -->
    <ul>
        {% for movie in movies %}
            <li style="margin-bottom: 20px;">
                <strong>{{ movie.name }}</strong> – {{ movie.director }} ({{ movie.year }})<br>
                {% if movie.poster_url %}
                    <img src="{{ movie.poster_url }}" alt="Poster" width="100">
                {% else %}
                    <em>No poster available</em>
                {% endif %}
                <br>
                <form method="post" action="{{ url_for('delete_movie', user_id=user_id, movie_id=movie.id) }}" style="display:inline;">
                    <button type="submit">🗑️</button>
                </form>
                <a href="{{ url_for('edit_movie', user_id=user_id, movie_id=movie.id) }}">🖊️</a>
            </li>
        {% else %}
            <li>No movies yet.</li>
        {% endfor %}
    </ul>

    <!-- Formular zum manuellen Hinzufügen -->
    <h3 id="add-movie-form">Add Movie</h3>
    <form method="post">
        <input type="text" name="name" placeholder="Title" required><br>
        <input type="text" name="director" placeholder="Director"><br>
        <input type="number" name="year" placeholder="Year"><br>
        <input type="text" name="poster_url" placeholder="Poster URL"><br>
        <button type="submit">Add Movie</button>
    </form>

    <br>
    <a href="{{ url_for('index') }}">← Back to Users</a>
{% endblock %}
